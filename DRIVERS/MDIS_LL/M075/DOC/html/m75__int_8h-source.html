<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>MEN - M75 MDIS Driver - m75_int.h Source File</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Language" content="en, english">
<meta name="Copyright" content="All material copyright MEN Mikro Elektronik GmbH">
<link href="men_stylesheet.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class="left_to_right" style="padding-top: 6px; background-color: #F0F0F0; height: 110px; border-bottom: 2px solid #D1D1D2;">
	<!-- Titel -->
	<img src="menlogo.gif" alt="MEN" style="float: left; height: 103px; width: 155px; margin: 0px;">
	<h1 style="margin: 0px; padding-top: 35px; padding-bottom: 0px;">M75 MDIS Driver &nbsp; </h1>
	<h3>m75_int.h Source File</h3>
</div>

<div class="left_to_right">
<!-- Hauptteil -->
	<div class="main">
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>m75_int.h</h1><a href="m75__int_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/***********************  I n c l u d e  -  F i l e  ************************/</span>
00011 <span class="comment">/*</span>
00012 <span class="comment"> *---------------------------------------------------------------------------</span>
00013 <span class="comment"> * Copyright (c) 2004-2019, MEN Mikro Elektronik GmbH</span>
00014 <span class="comment"> ****************************************************************************/</span>
00015 <span class="comment">/*</span>
00016 <span class="comment">* This program is free software: you can redistribute it and/or modify</span>
00017 <span class="comment">* it under the terms of the GNU General Public License as published by</span>
00018 <span class="comment">* the Free Software Foundation, either version 2 of the License, or</span>
00019 <span class="comment">* (at your option) any later version.</span>
00020 <span class="comment">*</span>
00021 <span class="comment">* This program is distributed in the hope that it will be useful,</span>
00022 <span class="comment">* but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00023 <span class="comment">* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00024 <span class="comment">* GNU General Public License for more details.</span>
00025 <span class="comment">*</span>
00026 <span class="comment">* You should have received a copy of the GNU General Public License</span>
00027 <span class="comment">* along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
00028 <span class="comment">*/</span>
00029 
00030 <span class="preprocessor">#ifdef __cplusplus</span>
00031 <span class="preprocessor"></span>    <span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00032 <span class="preprocessor">#endif</span>
00033 <span class="preprocessor"></span>
00034 <span class="preprocessor">#include &lt;MEN/men_typs.h&gt;</span>   <span class="comment">/* system dependend definitions   */</span>
00035 <span class="preprocessor">#include &lt;MEN/dbg.h&gt;</span>        <span class="comment">/* debug functions                */</span>
00036 <span class="preprocessor">#include &lt;MEN/oss.h&gt;</span>        <span class="comment">/* oss functions                  */</span>
00037 <span class="preprocessor">#include &lt;MEN/maccess.h&gt;</span>    <span class="comment">/* hw access macros and types     */</span>
00038 <span class="preprocessor">#include &lt;MEN/desc.h&gt;</span>       <span class="comment">/* descriptor functions           */</span>
00039 <span class="preprocessor">#include &lt;MEN/mdis_api.h&gt;</span>   <span class="comment">/* MDIS global defs               */</span>
00040 <span class="preprocessor">#include &lt;MEN/mdis_com.h&gt;</span>   <span class="comment">/* MDIS common defs               */</span>
00041 <span class="preprocessor">#include &lt;MEN/mdis_err.h&gt;</span>   <span class="comment">/* MDIS error codes               */</span>
00042 <span class="preprocessor">#include &lt;MEN/ll_defs.h&gt;</span>    <span class="comment">/* low level driver definitions   */</span>
00043 <span class="preprocessor">#include &lt;MEN/modcom.h&gt;</span>    <span class="comment">/* low level driver definitions   */</span>
00044 
00045 <span class="comment">/*-----------------------------------------+</span>
00046 <span class="comment">|  DEFINES                                 |</span>
00047 <span class="comment">+-----------------------------------------*/</span>
00048 <span class="comment">/* debug settings */</span>
00049 <span class="preprocessor">#define DBG_MYLEVEL         llHdl-&gt;dbgLevel</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#define DBH                 llHdl-&gt;dbgHdl</span>
00051 <span class="preprocessor"></span>
00052 <span class="comment">/* general MDIS defs */</span>
<a name="l00053"></a><a class="code" href="m75__int_8h.html#a2">00053</a> <span class="preprocessor">#define CH_NUMBER           2           </span>
<a name="l00054"></a><a class="code" href="m75__int_8h.html#a3">00054</a> <span class="preprocessor">#define USE_IRQ             TRUE        </span>
<a name="l00055"></a><a class="code" href="m75__int_8h.html#a4">00055</a> <span class="preprocessor">#define ADDRSPACE_COUNT     1           </span>
<a name="l00056"></a><a class="code" href="m75__int_8h.html#a5">00056</a> <span class="preprocessor">#define ADDRSPACE_SIZE      0x100       </span>
<a name="l00058"></a><a class="code" href="m75__int_8h.html#a6">00058</a> <span class="preprocessor">#define MOD_ID_MAGIC        0x5346      </span>
<a name="l00059"></a><a class="code" href="m75__int_8h.html#a7">00059</a> <span class="preprocessor">#define MOD_ID_SIZE         128         </span>
<a name="l00060"></a><a class="code" href="m75__int_8h.html#a8">00060</a> <span class="preprocessor">#define MOD_ID              75          </span>
00062 <span class="preprocessor"></span><span class="comment">/* M75 global registers */</span>
00063 <span class="preprocessor">#if (defined(_BIG_ENDIAN_) &amp;&amp; !defined(MAC_BYTESWAP))\</span>
00064 <span class="preprocessor">    || (defined(_LITTLE_ENDIAN_) &amp;&amp; defined(MAC_BYTESWAP))</span>
00065 <span class="preprocessor"></span><span class="preprocessor">#define DATA_REG_A 0x01     </span><span class="comment">/* equivalent to WR08 */</span>
00066 <span class="preprocessor">#define DATA_REG_B 0x03     </span><span class="comment">/* equivalent to WR08 */</span>
00067 <span class="preprocessor">#define COMM_REG_A 0x05     </span><span class="comment">/* equivalent to WR00 */</span>
00068 <span class="preprocessor">#define COMM_REG_B 0x07     </span><span class="comment">/* equivalent to WR00 */</span>
00069 <span class="preprocessor">#define FIFO_REG_A 0x09</span>
00070 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_REG_B 0x0B</span>
00071 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_STATREG_A 0x0D</span>
00072 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_STATREG_B 0x0F</span>
00073 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_RESET_REG 0x11</span>
00074 <span class="preprocessor"></span><span class="preprocessor">#define CHM_REG_A  0x13</span>
00075 <span class="preprocessor"></span><span class="preprocessor">#define CHM_REG_B  0x15</span>
00076 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00077 <span class="preprocessor"></span><span class="preprocessor">#define DATA_REG_A 0x00     </span><span class="comment">/* equivalent to WR08 */</span>
00078 <span class="preprocessor">#define DATA_REG_B 0x02     </span><span class="comment">/* equivalent to WR08 */</span>
00079 <span class="preprocessor">#define COMM_REG_A 0x04     </span><span class="comment">/* equivalent to WR00 */</span>
00080 <span class="preprocessor">#define COMM_REG_B 0x06     </span><span class="comment">/* equivalent to WR00 */</span>
00081 <span class="preprocessor">#define FIFO_REG_A 0x08</span>
00082 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_REG_B 0x0A</span>
00083 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_STATREG_A 0x0C</span>
00084 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_STATREG_B 0x0E</span>
00085 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_RESET_REG 0x10</span>
00086 <span class="preprocessor"></span><span class="preprocessor">#define CHM_REG_A  0x12</span>
00087 <span class="preprocessor"></span><span class="preprocessor">#define CHM_REG_B  0x14</span>
00088 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00089 <span class="preprocessor"></span>
00090 <span class="comment">/* SCC register offsets */</span>
00091 <span class="preprocessor">#define M75_R00     0x00    </span><span class="comment">/* WR00 &amp; RR00 */</span>
00092 <span class="preprocessor">#define M75_R01     0x01    </span><span class="comment">/* WR01 &amp; RR01 */</span>
00093 <span class="preprocessor">#define M75_R02     0x02    </span><span class="comment">/* WR02 &amp; RR02 */</span>
00094 <span class="preprocessor">#define M75_R03     0x03    </span><span class="comment">/* WR03 &amp; RR03 */</span>
00095 <span class="preprocessor">#define M75_R04     0x04    </span><span class="comment">/* WR04 &amp; RR04 */</span>
00096 <span class="preprocessor">#define M75_R05     0x05    </span><span class="comment">/* WR05 &amp; RR05 */</span>
00097 <span class="preprocessor">#define M75_R06     0x06    </span><span class="comment">/* WR06 &amp; RR06 */</span>
00098 <span class="preprocessor">#define M75_R07     0x07    </span><span class="comment">/* WR07 &amp; WR07' &amp; RR07 */</span>
00099 <span class="preprocessor">#define M75_R08     0x08    </span><span class="comment">/* WR08 &amp; RR08 */</span>
00100 <span class="preprocessor">#define M75_R09     0x09    </span><span class="comment">/* WR09 &amp; RR09 */</span>
00101 <span class="preprocessor">#define M75_R10     0x0A    </span><span class="comment">/* WR10 &amp; RR10 */</span>
00102 <span class="preprocessor">#define M75_R11     0x0B    </span><span class="comment">/* WR11 &amp; RR11 */</span>
00103 <span class="preprocessor">#define M75_R12     0x0C    </span><span class="comment">/* WR12 &amp; RR12 */</span>
00104 <span class="preprocessor">#define M75_R13     0x0D    </span><span class="comment">/* WR13 &amp; RR13 */</span>
00105 <span class="preprocessor">#define M75_R14     0x0E    </span><span class="comment">/* WR14 &amp; RR14 */</span>
00106 <span class="preprocessor">#define M75_R15     0x0F    </span><span class="comment">/* WR15 &amp; RR15 */</span>
00107 
00108 <span class="comment">/* M75 register bit definitions */</span>
00109 <span class="comment">/* global regs */</span>
00110 <span class="preprocessor">#define M75_FIFO_STATREG_TXFIFO_EMPTY 0x10  </span><span class="comment">/* Tx FIFOs empty */</span>
00111 <span class="preprocessor">#define M75_FIFO_STATREG_TXEN         0x80  </span><span class="comment">/* enable Tx FIFOs */</span>
00112 
00113 <span class="comment">/* WR00 */</span>
00114 <span class="preprocessor">#define M75_SCC_WR00_POINT_HIGH     0x08    </span><span class="comment">/* Point High */</span>
00115 <span class="preprocessor">#define M75_SCC_WR00_RST_EXT_STAT   0x10    </span><span class="comment">/* Reset Ext/Status Interrupts */</span>
00116 <span class="preprocessor">#define M75_SCC_WR00_SEND_ABORT     0x18    </span><span class="comment">/* SDLC Send Abort */</span>
00117 <span class="preprocessor">#define M75_SCC_WR00_EN_INT_NXT_RX  0x20    </span><span class="comment">/* Enable Int on Next Rx Char */</span>
00118 <span class="preprocessor">#define M75_SCC_WR00_RST_TXINT      0x28    </span><span class="comment">/* Reset Tx Int Pending */</span>
00119 <span class="preprocessor">#define M75_SCC_WR00_RST_ERROR      0x30    </span><span class="comment">/* Reset Error */</span>
00120 <span class="preprocessor">#define M75_SCC_WR00_RST_HIGH_IUS   0x38    </span><span class="comment">/* Reset Highest IUS */</span>
00121 
00122 <span class="preprocessor">#define M75_SCC_WR00_RST_RX_CRC     0x40    </span><span class="comment">/* Reset Rx CRC Checker */</span>
00123 <span class="preprocessor">#define M75_SCC_WR00_RST_TX_CRC     0x80    </span><span class="comment">/* Reset Tx CRC Generator */</span>
00124 <span class="preprocessor">#define M75_SCC_WR00_RST_UNDERR_EOM 0xC0    </span><span class="comment">/* Reset Tx Underrun/EOM Latch */</span>
00125 
00126 <span class="comment">/* WR01 */</span>
00127 <span class="preprocessor">#define M75_SCC_WR01_EXT_IE         0x01    </span><span class="comment">/* Ext Int Enable */</span>
00128 <span class="preprocessor">#define M75_SCC_WR01_TX_IE          0x02    </span><span class="comment">/* Tx Int Enable */</span>
00129 <span class="preprocessor">#define M75_SCC_WR01_PAR_SPEC_COND  0x04    </span><span class="comment">/* Parity is Special Condition */</span>
00130 
00131 <span class="preprocessor">#define M75_SCC_WR01_RX_FIRST_SPEC_IE 0x08  </span><span class="comment">/* MASK: Rx Int On First Char or Special Condition */</span>
00132 <span class="preprocessor">#define M75_SCC_WR01_RX_ALL_SPEC_IE   0x10  </span><span class="comment">/* MASK: Rx Int On All Char or Special Condition */</span>
00133 <span class="preprocessor">#define M75_SCC_WR01_RX_SPEC_ONLY_IE  0x18  </span><span class="comment">/* MASK: Rx Int On Special Condition Only */</span>
00134 
00135 <span class="comment">/* WR03 */</span>
00136 <span class="preprocessor">#define M75_SCC_WR03_RX_EN          0x01    </span><span class="comment">/* Rx Enable */</span>
00137 
00138 <span class="comment">/* WR05 */</span>
00139 <span class="preprocessor">#define M75_SCC_WR05_TX_CRC_EN      0x01    </span><span class="comment">/* Tx CRC Enable */</span>
00140 <span class="preprocessor">#define M75_SCC_WR05_TX_EN          0x08    </span><span class="comment">/* Tx Enable */</span>
00141 <span class="preprocessor">#define M75_SCC_WR05_TX_BPC_MASK    0x60    </span><span class="comment">/* Tx Bits/Character Mask */</span>
00142 <span class="preprocessor">#define M75_SCC_WR05_TX_5BPC        0x00    </span><span class="comment">/* Tx 5 Bits(Or Less)/Char */</span>
00143 <span class="preprocessor">#define M75_SCC_WR05_TX_6BPC        0x20    </span><span class="comment">/* Tx 6 Bits/Char */</span>
00144 <span class="preprocessor">#define M75_SCC_WR05_TX_7BPC        0x40    </span><span class="comment">/* Tx 7 Bits/Char */</span>
00145 <span class="preprocessor">#define M75_SCC_WR05_TX_8BPC        0x60    </span><span class="comment">/* Tx 8 Bits/Char */</span>
00146 
00147 <span class="comment">/* WR07 */</span>
00148 <span class="preprocessor">#define M75_SCC_WR07P_TX_FIFO_EMPTY 0x20    </span><span class="comment">/* Tx FIFO Empty */</span>
00149 
00150 <span class="comment">/* WR09 */</span>
00151 <span class="preprocessor">#define M75_SCC_WR09_MIE            0x08    </span><span class="comment">/* Master Interrupt Enable */</span>
00152 <span class="preprocessor">#define M75_SCC_WR09_RST_CHB        0x40    </span><span class="comment">/* Channel Reset B */</span>
00153 <span class="preprocessor">#define M75_SCC_WR09_RST_CHA        0x80    </span><span class="comment">/* Channel Reset A */</span>
00154 <span class="preprocessor">#define M75_SCC_WR09_RST_HW         0xC0    </span><span class="comment">/* Force HW Reset */</span>
00155 
00156 <span class="comment">/* WR14 */</span>
00157 <span class="preprocessor">#define M75_SCC_WR14_BRG_EN         0x01        </span><span class="comment">/* BR Generator Enable */</span>
00158 
00159 <span class="comment">/* WR15 */</span>
00160 <span class="preprocessor">#define M75_SCC_WR15_WR7P_EN        0x01    </span><span class="comment">/* WR7' SDLC Feature Enable */</span>
00161 <span class="preprocessor">#define M75_SCC_WR15_SDLC_FIFO_EN   0x04    </span><span class="comment">/* SDLC Status FIFO Enable */</span>
00162 <span class="preprocessor">#define M75_SCC_WR15_DCD_IE         0x08    </span><span class="comment">/* DCD Interrupt enable */</span>
00163 <span class="preprocessor">#define M75_SCC_WR15_SYNC_HUNT_IE   0x10    </span><span class="comment">/* SYNC/HUNT Interrupt enable */</span>
00164 <span class="preprocessor">#define M75_SCC_WR15_CTS_IE         0x20    </span><span class="comment">/* CTS Interrupt enable */</span>
00165 <span class="preprocessor">#define M75_SCC_WR15_TX_UNDR_EOM_IE 0x40    </span><span class="comment">/* Tx Underrun/EOM Interrupt enable */</span>
00166 <span class="preprocessor">#define M75_SCC_WR15_BREAK_ABORT_IE 0x80    </span><span class="comment">/* Break/Abort Interrupt enable */</span>
00167 
00168 <span class="comment">/* RR00 */</span>
00169 <span class="preprocessor">#define M75_SCC_RR00_RX_CHAR_AVAIL  0x01    </span><span class="comment">/* Rx Character Available */</span>
00170 <span class="preprocessor">#define M75_SCC_RR00_ZERO_CNT       0x02    </span><span class="comment">/* Zero Count */</span>
00171 <span class="preprocessor">#define M75_SCC_RR00_TX_BUF_EMPTY   0x04    </span><span class="comment">/* Tx Buffer Empty */</span>
00172 <span class="preprocessor">#define M75_SCC_RR00_DCD            0x08    </span><span class="comment">/* DCD */</span>
00173 <span class="preprocessor">#define M75_SCC_RR00_SYNC_HUNT      0x10    </span><span class="comment">/* Sync/Hunt */</span>
00174 <span class="preprocessor">#define M75_SCC_RR00_CTS            0x20    </span><span class="comment">/* CTS */</span>
00175 <span class="preprocessor">#define M75_SCC_RR00_TX_UNDR_EOM    0x40    </span><span class="comment">/* Tx Underrun/EOM */</span>
00176 <span class="preprocessor">#define M75_SCC_RR00_BREAK_ABORT    0x80    </span><span class="comment">/* Break/Abort */</span>
00177 
00178 <span class="comment">/* RR01 */</span>
00179 <span class="preprocessor">#define M75_SCC_RR01_ALL_SENT       0x01    </span><span class="comment">/* All Sent */</span>
00180 <span class="preprocessor">#define M75_SCC_RR01_ERR_PAR        0x10    </span><span class="comment">/* Parity Error */</span>
00181 <span class="preprocessor">#define M75_SCC_RR01_ERR_RX_OVR     0x20    </span><span class="comment">/* Rx Overrun Error */</span>
00182 <span class="preprocessor">#define M75_SCC_RR01_ERR_CRC_FRM    0x40    </span><span class="comment">/* CRC/Framing Error */</span>
00183 <span class="preprocessor">#define M75_SCC_RR01_END_FRAME      0x80    </span><span class="comment">/* End Of Frame (SDLC) */</span>
00184 
00185 <span class="comment">/* RR03 */</span>
00186 <span class="preprocessor">#define M75_SCC_RR03_CHB_EXTSTAT_IP 0x01    </span><span class="comment">/* Channel B Ext/Status Interrupt pending */</span>
00187 <span class="preprocessor">#define M75_SCC_RR03_CHB_TX_IP      0x02    </span><span class="comment">/* Channel B Tx Interrupt pending */</span>
00188 <span class="preprocessor">#define M75_SCC_RR03_CHB_RX_IP      0x04    </span><span class="comment">/* Channel B Rx Interrupt pending */</span>
00189 <span class="preprocessor">#define M75_SCC_RR03_CHA_EXTSTAT_IP 0x08    </span><span class="comment">/* Channel A Ext/Status Interrupt pending */</span>
00190 <span class="preprocessor">#define M75_SCC_RR03_CHA_TX_IP      0x10    </span><span class="comment">/* Channel A Tx Interrupt pending */</span>
00191 <span class="preprocessor">#define M75_SCC_RR03_CHA_RX_IP      0x20    </span><span class="comment">/* Channel A Rx Interrupt pending */</span>
00192 
00193 <span class="comment">/* RR07 */</span>
00194 <span class="preprocessor">#define M75_SCC_RR07_BC_MASK        0x3F    </span><span class="comment">/* Byte Count Mask */</span>
00195 <span class="preprocessor">#define M75_SCC_RR07_FDA            0x40    </span><span class="comment">/* FIFO Data Available */</span>
00196 <span class="preprocessor">#define M75_SCC_RR07_FOS            0x80    </span><span class="comment">/* FIFO Overflow Status */</span>
00197 
00198 <span class="comment">/* other defines */</span>
00199 <span class="preprocessor">#define M75_DELAY           100     </span><span class="comment">/* Delay in msec */</span>
00200 <span class="preprocessor">#define M75_SYNC_MODE       1       </span><span class="comment">/* Default mode is SYNC */</span>
00201 <span class="preprocessor">#define FRAME_NUM_DEF       0x010   </span><span class="comment">/* Default maximum frame number */</span>
00202 <span class="preprocessor">#define FRAME_SIZE_DEF      0x800   </span><span class="comment">/* Default maximum frame size */</span>
00203 <span class="preprocessor">#define GETSETBLOCK_TOUT    0x000   </span><span class="comment">/* Default maximum frame size */</span>
00204 <span class="preprocessor">#define M75_WR01_MASK_INT   0x1F    </span><span class="comment">/* Mask IEs in WR01 */</span>
00205 <span class="preprocessor">#define M75_WR15_MASK_INT   0xFA    </span><span class="comment">/* Mask Ext/Status IEs in WR15 */</span>
00206 
00207 <span class="preprocessor">#ifdef M75_SUPPORT_BREAK_ABORT</span>
00208 <span class="preprocessor"></span><span class="preprocessor">    #define M75_WR15_EN_INT (M75_SCC_WR15_TX_UNDR_EOM_IE | M75_SCC_WR15_BREAK_ABORT_IE) </span><span class="comment">/* Interrupts to be enabled */</span>
00209                                     <span class="comment">/* Break/Abort, TxUnderr/EOM */</span>
00210 <span class="preprocessor">#else</span>
00211 <span class="preprocessor"></span><span class="preprocessor">    #define M75_WR15_EN_INT (M75_SCC_WR15_TX_UNDR_EOM_IE)   </span><span class="comment">/* Interrupts to be enabled */</span>
00212                                      <span class="comment">/* Tx Underrun/EOM */</span>
00213 <span class="preprocessor">#endif</span>
00214 <span class="preprocessor"></span>
00215 <span class="comment">/* Macros for accessing SCC registers */</span>
00216 <span class="preprocessor">#define WRITE_SCC_COMM( ma,ch,val )                     \</span>
00217 <span class="preprocessor">    do {                                                \</span>
00218 <span class="preprocessor">        if( ch == 0 ){  </span><span class="comment">/* write to channel A */</span>        \
00219             MWRITE_D8( ma, COMM_REG_A, val );           \
00220             IDBGWRT_6( (DBH, "Write COMM_REG_A %02X\n", val) ); \
00221         } else {        <span class="comment">/* write to channel B */</span>        \
00222             MWRITE_D8( ma, COMM_REG_B, val );           \
00223             IDBGWRT_6( (DBH, "Write COMM_REG_B %02X\n", val) ); \
00224         }                                               \
00225     } while( 0 )
00226 
00227 <span class="preprocessor">#define READ_SCC_COMM( ma,ch,val )                      \</span>
00228 <span class="preprocessor">    do {                                                \</span>
00229 <span class="preprocessor">        if( ch == 0 ){  </span><span class="comment">/* write to channel A */</span>        \
00230             val = MREAD_D8( ma, COMM_REG_A );   \
00231             IDBGWRT_6( (DBH, "Read  COMM_REG_A %02X\n", val) ); \
00232         } else {        <span class="comment">/* write to channel B */</span>        \
00233             val = MREAD_D8( ma, COMM_REG_B );   \
00234             IDBGWRT_6( (DBH, "Read  COMM_REG_B %02X\n", val) ); \
00235         }                                               \
00236     } while( 0 )
00237 
00238 <span class="preprocessor">#define WRITE_SCC_REG( ma,ch,reg,val )                              \</span>
00239 <span class="preprocessor">    do {                                                            \</span>
00240 <span class="preprocessor">        OSS_IRQ_STATE irqStateWAcc;                                 \</span>
00241 <span class="preprocessor">        irqStateWAcc = OSS_IrqMaskR(llHdl-&gt;osHdl, llHdl-&gt;irqHdl);   \</span>
00242 <span class="preprocessor">        WRITE_SCC_COMM( ma,ch,reg );                                \</span>
00243 <span class="preprocessor">        WRITE_SCC_COMM( ma,ch,val );                                \</span>
00244 <span class="preprocessor">        if( reg == M75_R08) {   </span><span class="comment">/* data register, do nothing more */</span>\
00245         } else if( reg != M75_R07 ) { <span class="comment">/* normal SCC register */</span>     \
00246             <span class="comment">/* mirror it */</span>                                         \
00247             *llHdl-&gt;chan[ch].sccRegs.wrp[reg] = val;                \
00248         } else if( (reg == M75_R07) &amp;&amp;                              \
00249                    (llHdl-&gt;chan[ch].sccRegs.wr15 &amp; M75_SCC_WR15_WR7P_EN) ) {<span class="comment">/* WR7P */</span>  \
00250             llHdl-&gt;chan[ch].sccRegs.wr7p = val;                     \
00251         } else if( reg == M75_R07 ){                     <span class="comment">/* WR07 */</span> \
00252             llHdl-&gt;chan[ch].sccRegs.wr07 = val;                     \
00253         }                                                           \
00254         OSS_IrqRestore( llHdl-&gt;osHdl, llHdl-&gt;irqHdl, irqStateWAcc ); \
00255         IDBGWRT_5( (DBH, "Write ch %d SCC Reg %02d: %02X\n", ch, reg, val) ); \
00256     } while( 0 )
00257 
00258 <span class="preprocessor">#define READ_SCC_REG( ma,ch,reg,val )                               \</span>
00259 <span class="preprocessor">    do {                                                            \</span>
00260 <span class="preprocessor">        OSS_IRQ_STATE irqStateRAcc;                                 \</span>
00261 <span class="preprocessor">        irqStateRAcc = OSS_IrqMaskR(llHdl-&gt;osHdl, llHdl-&gt;irqHdl);   \</span>
00262 <span class="preprocessor">        WRITE_SCC_COMM( ma,ch,reg );                                \</span>
00263 <span class="preprocessor">        READ_SCC_COMM( ma,ch,val );                                 \</span>
00264 <span class="preprocessor">        OSS_IrqRestore( llHdl-&gt;osHdl, llHdl-&gt;irqHdl, irqStateRAcc ); \</span>
00265 <span class="preprocessor">        IDBGWRT_5( (DBH, "Read  ch %d SCC Reg %02d: %02X\n", ch, reg, val) ); \</span>
00266 <span class="preprocessor">    } while( 0 )</span>
00267 <span class="preprocessor"></span>
<a name="l00269"></a><a class="code" href="m75__int_8h.html#a109">00269</a> <span class="preprocessor">#define DEVSEM_UNLOCK(llHdl) \</span>
00270 <span class="preprocessor"> if( llHdl-&gt;devSemHdl ) OSS_SemSignal( llHdl-&gt;osHdl, llHdl-&gt;devSemHdl );</span>
00271 <span class="preprocessor"></span>
00273 <span class="comment">/* ??? while( error == ERR_OSS_SIG_OCCURED ) might be a problem in Linux???*/</span>
<a name="l00274"></a><a class="code" href="m75__int_8h.html#a110">00274</a> <span class="preprocessor">#define DEVSEM_LOCK(llHdl) \</span>
00275 <span class="preprocessor"> if( llHdl-&gt;devSemHdl ){ \</span>
00276 <span class="preprocessor">     int32 error;\</span>
00277 <span class="preprocessor">     do {\</span>
00278 <span class="preprocessor">         error=OSS_SemWait( llHdl-&gt;osHdl, llHdl-&gt;devSemHdl, OSS_SEM_WAITFOREVER );\</span>
00279 <span class="preprocessor">     } while( error == ERR_OSS_SIG_OCCURED );\</span>
00280 <span class="preprocessor"> }</span>
00281 <span class="preprocessor"></span>
00282 <span class="comment">/*-----------------------------------------+</span>
00283 <span class="comment">|  TYPEDEFS                                |</span>
00284 <span class="comment">+-----------------------------------------*/</span>
00285 
<a name="l00287"></a><a class="code" href="structSCC__REG.html">00287</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00288"></a><a class="code" href="structSCC__REG.html#o0">00288</a>     u_int8          wr00;   
<a name="l00289"></a><a class="code" href="structSCC__REG.html#o1">00289</a>     u_int8          wr01;   
<a name="l00290"></a><a class="code" href="structSCC__REG.html#o2">00290</a>     u_int8          wr02;   
<a name="l00291"></a><a class="code" href="structSCC__REG.html#o3">00291</a>     u_int8          wr03;   
<a name="l00292"></a><a class="code" href="structSCC__REG.html#o4">00292</a>     u_int8          wr04;   
<a name="l00293"></a><a class="code" href="structSCC__REG.html#o5">00293</a>     u_int8          wr05;   
<a name="l00294"></a><a class="code" href="structSCC__REG.html#o6">00294</a>     u_int8          wr06;   
<a name="l00295"></a><a class="code" href="structSCC__REG.html#o7">00295</a>     u_int8          wr07;   
<a name="l00296"></a><a class="code" href="structSCC__REG.html#o8">00296</a>     u_int8          wr7p;   
<a name="l00297"></a><a class="code" href="structSCC__REG.html#o9">00297</a>     u_int8          wr09;   
<a name="l00298"></a><a class="code" href="structSCC__REG.html#o10">00298</a>     u_int8          wr10;   
<a name="l00299"></a><a class="code" href="structSCC__REG.html#o11">00299</a>     u_int8          wr11;   
<a name="l00300"></a><a class="code" href="structSCC__REG.html#o12">00300</a>     u_int8          wr12;   
<a name="l00301"></a><a class="code" href="structSCC__REG.html#o13">00301</a>     u_int8          wr13;   
<a name="l00302"></a><a class="code" href="structSCC__REG.html#o14">00302</a>     u_int8          wr14;   
<a name="l00303"></a><a class="code" href="structSCC__REG.html#o15">00303</a>     u_int8          wr15;   
00304     u_int8          *wrp[16]; <span class="comment">/* pointers to above registers */</span>
00305 } <a class="code" href="structSCC__REG.html">SCC_REG</a>;
00306 
00307 
<a name="l00309"></a><a class="code" href="structmqueue__ent.html">00309</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmqueue__ent.html">mqueue_ent</a> {
<a name="l00310"></a><a class="code" href="structmqueue__ent.html#o0">00310</a>     <span class="keyword">struct </span><a class="code" href="structmqueue__ent.html">mqueue_ent</a>   *next;      
<a name="l00311"></a><a class="code" href="structmqueue__ent.html#o1">00311</a>     u_int8              *<a class="code" href="structmqueue__ent.html#o1">frame</a>;     
<a name="l00312"></a><a class="code" href="structmqueue__ent.html#o2">00312</a>     u_int32             <a class="code" href="structmqueue__ent.html#o2">size</a>;       
<a name="l00313"></a><a class="code" href="structmqueue__ent.html#o3">00313</a>     u_int8              <a class="code" href="structmqueue__ent.html#o3">ready</a>;      
<a name="l00314"></a><a class="code" href="structmqueue__ent.html#o4">00314</a>     u_int8              <a class="code" href="structmqueue__ent.html#o4">xfering</a>;    
00315 } <a class="code" href="structmqueue__ent.html">MQUEUE_ENT</a>;
00316 
<a name="l00318"></a><a class="code" href="structMQUEUE__HEAD.html">00318</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00319"></a><a class="code" href="structMQUEUE__HEAD.html#o0">00319</a>     <a class="code" href="structmqueue__ent.html">MQUEUE_ENT</a>  *first;         
<a name="l00320"></a><a class="code" href="structMQUEUE__HEAD.html#o1">00320</a>     <a class="code" href="structmqueue__ent.html">MQUEUE_ENT</a>  *last;          
<a name="l00321"></a><a class="code" href="structMQUEUE__HEAD.html#o2">00321</a>     <span class="keywordtype">void</span>        *startAlloc;    
<a name="l00322"></a><a class="code" href="structMQUEUE__HEAD.html#o3">00322</a>     OSS_SEM_HANDLE *sem;        
<a name="l00323"></a><a class="code" href="structMQUEUE__HEAD.html#o4">00323</a>     u_int32     totEntries;     
<a name="l00324"></a><a class="code" href="structMQUEUE__HEAD.html#o5">00324</a>     u_int32     memAlloc;       
<a name="l00325"></a><a class="code" href="structMQUEUE__HEAD.html#o6">00325</a>     u_int32     maxFrameSize;   
<a name="l00326"></a><a class="code" href="structMQUEUE__HEAD.html#o7">00326</a>     u_int32     maxFrameNum;    
<a name="l00327"></a><a class="code" href="structMQUEUE__HEAD.html#o8">00327</a>     u_int8      errSent;        
<a name="l00328"></a><a class="code" href="structMQUEUE__HEAD.html#o9">00328</a>     u_int8      qinit;          
<a name="l00329"></a><a class="code" href="structMQUEUE__HEAD.html#o10">00329</a>     u_int8      waiting;        
00330 } <a class="code" href="structMQUEUE__HEAD.html">MQUEUE_HEAD</a>;
00331 
<a name="l00333"></a><a class="code" href="structCHN__OBJ.html">00333</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00334"></a><a class="code" href="structCHN__OBJ.html#o0">00334</a>     <a class="code" href="structMQUEUE__HEAD.html">MQUEUE_HEAD</a>     rxQ;            
<a name="l00335"></a><a class="code" href="structCHN__OBJ.html#o1">00335</a>     <a class="code" href="structMQUEUE__HEAD.html">MQUEUE_HEAD</a>     txQ;            
<a name="l00336"></a><a class="code" href="structCHN__OBJ.html#o2">00336</a>     OSS_SIG_HANDLE  *sig;           
<a name="l00337"></a><a class="code" href="structCHN__OBJ.html#o3">00337</a>     u_int32         asyRxSigWaterM; 
<a name="l00338"></a><a class="code" href="structCHN__OBJ.html#o4">00338</a>     int32       rxERR;          
<a name="l00339"></a><a class="code" href="structCHN__OBJ.html#o5">00339</a>     <a class="code" href="structSCC__REG.html">SCC_REG</a>     sccRegs;        
<a name="l00340"></a><a class="code" href="structCHN__OBJ.html#o6">00340</a>     u_int32     getBlockTout;   
<a name="l00341"></a><a class="code" href="structCHN__OBJ.html#o7">00341</a>     u_int32     setBlockTout;   
<a name="l00342"></a><a class="code" href="structCHN__OBJ.html#o8">00342</a>     u_int8      syncMode;       
<a name="l00343"></a><a class="code" href="structCHN__OBJ.html#o9">00343</a>     u_int8      irqEnabled;     
<a name="l00344"></a><a class="code" href="structCHN__OBJ.html#o10">00344</a>     u_int8      txUnderrEOMgot; 
<a name="l00345"></a><a class="code" href="structCHN__OBJ.html#o11">00345</a>     u_int8      txBufEmpty;     
<a name="l00346"></a><a class="code" href="structCHN__OBJ.html#o12">00346</a>     u_int8      rxStatCnt;      
00347 } <a class="code" href="structCHN__OBJ.html">CHN_OBJ</a>;
00348 
<a name="l00350"></a><a class="code" href="structLL__HANDLE.html">00350</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00351     <span class="comment">/* general */</span>
<a name="l00352"></a><a class="code" href="structLL__HANDLE.html#o0">00352</a>     int32           memAlloc;       
<a name="l00353"></a><a class="code" href="structLL__HANDLE.html#o1">00353</a>     OSS_HANDLE      *osHdl;         
<a name="l00354"></a><a class="code" href="structLL__HANDLE.html#o2">00354</a>     OSS_IRQ_HANDLE  *irqHdl;        
<a name="l00355"></a><a class="code" href="structLL__HANDLE.html#o3">00355</a>     DESC_HANDLE     *descHdl;       
<a name="l00356"></a><a class="code" href="structLL__HANDLE.html#o4">00356</a>     MACCESS         ma;             
<a name="l00357"></a><a class="code" href="structLL__HANDLE.html#o5">00357</a>     MDIS_IDENT_FUNCT_TBL idFuncTbl; 
<a name="l00358"></a><a class="code" href="structLL__HANDLE.html#o6">00358</a>     OSS_SEM_HANDLE  *devSemHdl;     
00359     <span class="comment">/* debug */</span>
<a name="l00360"></a><a class="code" href="structLL__HANDLE.html#o7">00360</a>     u_int32         dbgLevel;       
<a name="l00361"></a><a class="code" href="structLL__HANDLE.html#o8">00361</a>     DBG_HANDLE      *dbgHdl;        
<a name="l00363"></a><a class="code" href="structLL__HANDLE.html#o9">00363</a>     <a class="code" href="structCHN__OBJ.html">CHN_OBJ</a>         chan[2];        
<a name="l00365"></a><a class="code" href="structLL__HANDLE.html#o10">00365</a>     u_int8          irqEnabled;     
<a name="l00367"></a><a class="code" href="structLL__HANDLE.html#o11">00367</a>     u_int32         irqCount;       
<a name="l00369"></a><a class="code" href="structLL__HANDLE.html#o12">00369</a>     u_int32         idCheck;        
00370     u_int32         maxIrqTime;
00371 } <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a>;
00372 
00373 <span class="comment">/* include files which need LL_HANDLE */</span>
00374 <span class="preprocessor">#include &lt;MEN/ll_entry.h&gt;</span>   <span class="comment">/* low-level driver jump table  */</span>
00375 <span class="preprocessor">#include &lt;<a class="code" href="m75__drv_8h.html">MEN/m75_drv.h</a>&gt;</span>   <span class="comment">/* M75 driver header file */</span>
00376 
00377 
00378 <span class="comment">/*--------------------------------------+</span>
00379 <span class="comment">|   STATICS                             |</span>
00380 <span class="comment">+--------------------------------------*/</span>
00381 
00382 <span class="comment">/*--------------------------------------+</span>
00383 <span class="comment">|   PROTOTYPES                          |</span>
00384 <span class="comment">+--------------------------------------*/</span>
00385 
00386 <span class="preprocessor">#ifdef __cplusplus</span>
00387 <span class="preprocessor"></span>    }
00388 <span class="preprocessor">#endif</span>
00389 <span class="preprocessor"></span>
00390 
00391 
00392 
00393 
00394 
</pre></div>
	</div>
</div>

<div class="footer">
<!-- Footer -->
	<p class="footer">
	Generated for M75 MDIS Driver using <a href="http://www.doxygen.org">doxygen</a>. All Rights Reserved.
	</p>
</div>

</body>
</html>

