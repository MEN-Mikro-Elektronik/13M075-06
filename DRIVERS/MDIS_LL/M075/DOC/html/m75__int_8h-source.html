<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>MEN - M75 MDIS Driver - m75_int.h Source File</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Language" content="en, english">
<meta name="Copyright" content="All material copyright MEN Mikro Elektronik GmbH">
<link href="men_stylesheet.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class="left_to_right" style="padding-top: 6px; background-color: #F0F0F0; height: 110px; border-bottom: 2px solid #D1D1D2;">
	<!-- Titel -->
	<img src="menlogo.gif" alt="MEN" style="float: left; height: 103px; width: 155px; margin: 0px;"></a>
	<h1 style="margin: 0px; padding-top: 35px; padding-bottom: 0px;">M75 MDIS Driver &nbsp; </h1>
	<h3>m75_int.h Source File</h3>
</div>

<div class="left_to_right">
<!-- Hauptteil -->
	<div class="main">
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>m75_int.h</h1><a href="m75__int_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/***********************  I n c l u d e  -  F i l e  ************************/</span>
00013 <span class="comment">/*-------------------------------[ History ]---------------------------------</span>
00014 <span class="comment"> *</span>
00015 <span class="comment"> * $Log: m75__int_8h-source.html,v $
00015 <span class="comment"> * Revision 1.8  2009/07/17 10:45:28  cs
00015 <span class="comment"> * (AUTOCI) Checkin due to new revision 3.1 of fileset ART/13M075-06/13M075-06
00015 <span class="comment"> *</span>
00016 <span class="comment"> * Revision 1.6  2009/07/14 17:47:16  cs</span>
00017 <span class="comment"> * R:1. driver used "magic numbers" for register bit settings</span>
00018 <span class="comment"> *   2. DBGWRT_* in SCC_* access macros where not interrupt safe</span>
00019 <span class="comment"> * M:1. add definitions for some register bits and masks</span>
00020 <span class="comment"> *   2.a) changed DBGWRT macros in SCC_* access macros to IDBGWRT_*</span>
00021 <span class="comment"> *     b) lowered level for debug outputs to 5-6</span>
00022 <span class="comment"> *</span>
00023 <span class="comment"> * Revision 1.5  2005/02/07 16:12:40  cs</span>
00024 <span class="comment"> * Added switch M75_SUPPORT_BREAK_ABORT (only affects M75_WR15_EN_INT)</span>
00025 <span class="comment"> *</span>
00026 <span class="comment"> * Revision 1.3  2004/12/29 19:34:54  cs</span>
00027 <span class="comment"> * Added define for interrupt enable in WR15</span>
00028 <span class="comment"> *</span>
00029 <span class="comment"> * Revision 1.2  2004/08/31 12:07:03  cs</span>
00030 <span class="comment"> * write access optimized</span>
00031 <span class="comment"> * added irqEnabled flag to each channel</span>
00032 <span class="comment"> *</span>
00033 <span class="comment"> * Revision 1.1  2004/08/06 11:20:19  cs</span>
00034 <span class="comment"> * Initial Revision</span>
00035 <span class="comment"> *</span>
00036 <span class="comment"> *</span>
00037 <span class="comment"> *---------------------------------------------------------------------------</span>
00038 <span class="comment"> * (c) Copyright 2004 by MEN Mikro Elektronik GmbH, Nuernberg, Germany</span>
00039 <span class="comment"> ****************************************************************************/</span>
00040 
00041 <span class="preprocessor">#ifdef __cplusplus</span>
00042 <span class="preprocessor"></span>    <span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00043 <span class="preprocessor">#endif</span>
00044 <span class="preprocessor"></span>
00045 <span class="preprocessor">#include &lt;MEN/men_typs.h&gt;</span>   <span class="comment">/* system dependend definitions   */</span>
00046 <span class="preprocessor">#include &lt;MEN/dbg.h&gt;</span>        <span class="comment">/* debug functions                */</span>
00047 <span class="preprocessor">#include &lt;MEN/oss.h&gt;</span>        <span class="comment">/* oss functions                  */</span>
00048 <span class="preprocessor">#include &lt;MEN/maccess.h&gt;</span>    <span class="comment">/* hw access macros and types     */</span>
00049 <span class="preprocessor">#include &lt;MEN/desc.h&gt;</span>       <span class="comment">/* descriptor functions           */</span>
00050 <span class="preprocessor">#include &lt;MEN/mdis_api.h&gt;</span>   <span class="comment">/* MDIS global defs               */</span>
00051 <span class="preprocessor">#include &lt;MEN/mdis_com.h&gt;</span>   <span class="comment">/* MDIS common defs               */</span>
00052 <span class="preprocessor">#include &lt;MEN/mdis_err.h&gt;</span>   <span class="comment">/* MDIS error codes               */</span>
00053 <span class="preprocessor">#include &lt;MEN/ll_defs.h&gt;</span>    <span class="comment">/* low level driver definitions   */</span>
00054 <span class="preprocessor">#include &lt;MEN/modcom.h&gt;</span>    <span class="comment">/* low level driver definitions   */</span>
00055 
00056 <span class="comment">/*-----------------------------------------+</span>
00057 <span class="comment">|  DEFINES                                 |</span>
00058 <span class="comment">+-----------------------------------------*/</span>
00059 <span class="comment">/* debug settings */</span>
00060 <span class="preprocessor">#define DBG_MYLEVEL         llHdl-&gt;dbgLevel</span>
00061 <span class="preprocessor"></span><span class="preprocessor">#define DBH                 llHdl-&gt;dbgHdl</span>
00062 <span class="preprocessor"></span>
00063 <span class="comment">/* general MDIS defs */</span>
<a name="l00064"></a><a class="code" href="m75__int_8h.html#a2">00064</a> <span class="preprocessor">#define CH_NUMBER           2           </span>
<a name="l00065"></a><a class="code" href="m75__int_8h.html#a3">00065</a> <span class="preprocessor">#define USE_IRQ             TRUE        </span>
<a name="l00066"></a><a class="code" href="m75__int_8h.html#a4">00066</a> <span class="preprocessor">#define ADDRSPACE_COUNT     1           </span>
<a name="l00067"></a><a class="code" href="m75__int_8h.html#a5">00067</a> <span class="preprocessor">#define ADDRSPACE_SIZE      0x100       </span>
<a name="l00069"></a><a class="code" href="m75__int_8h.html#a6">00069</a> <span class="preprocessor">#define MOD_ID_MAGIC        0x5346      </span>
<a name="l00070"></a><a class="code" href="m75__int_8h.html#a7">00070</a> <span class="preprocessor">#define MOD_ID_SIZE         128         </span>
<a name="l00071"></a><a class="code" href="m75__int_8h.html#a8">00071</a> <span class="preprocessor">#define MOD_ID              75          </span>
00073 <span class="preprocessor"></span><span class="comment">/* M75 global registers */</span>
00074 <span class="preprocessor">#if (defined(_BIG_ENDIAN_) &amp;&amp; !defined(MAC_BYTESWAP))\</span>
00075 <span class="preprocessor">    || (defined(_LITTLE_ENDIAN_) &amp;&amp; defined(MAC_BYTESWAP))</span>
00076 <span class="preprocessor"></span><span class="preprocessor">#define DATA_REG_A 0x01     </span><span class="comment">/* equivalent to WR08 */</span>
00077 <span class="preprocessor">#define DATA_REG_B 0x03     </span><span class="comment">/* equivalent to WR08 */</span>
00078 <span class="preprocessor">#define COMM_REG_A 0x05     </span><span class="comment">/* equivalent to WR00 */</span>
00079 <span class="preprocessor">#define COMM_REG_B 0x07     </span><span class="comment">/* equivalent to WR00 */</span>
00080 <span class="preprocessor">#define FIFO_REG_A 0x09</span>
00081 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_REG_B 0x0B</span>
00082 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_STATREG_A 0x0D</span>
00083 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_STATREG_B 0x0F</span>
00084 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_RESET_REG 0x11</span>
00085 <span class="preprocessor"></span><span class="preprocessor">#define CHM_REG_A  0x13</span>
00086 <span class="preprocessor"></span><span class="preprocessor">#define CHM_REG_B  0x15</span>
00087 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00088 <span class="preprocessor"></span><span class="preprocessor">#define DATA_REG_A 0x00     </span><span class="comment">/* equivalent to WR08 */</span>
00089 <span class="preprocessor">#define DATA_REG_B 0x02     </span><span class="comment">/* equivalent to WR08 */</span>
00090 <span class="preprocessor">#define COMM_REG_A 0x04     </span><span class="comment">/* equivalent to WR00 */</span>
00091 <span class="preprocessor">#define COMM_REG_B 0x06     </span><span class="comment">/* equivalent to WR00 */</span>
00092 <span class="preprocessor">#define FIFO_REG_A 0x08</span>
00093 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_REG_B 0x0A</span>
00094 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_STATREG_A 0x0C</span>
00095 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_STATREG_B 0x0E</span>
00096 <span class="preprocessor"></span><span class="preprocessor">#define FIFO_RESET_REG 0x10</span>
00097 <span class="preprocessor"></span><span class="preprocessor">#define CHM_REG_A  0x12</span>
00098 <span class="preprocessor"></span><span class="preprocessor">#define CHM_REG_B  0x14</span>
00099 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00100 <span class="preprocessor"></span>
00101 <span class="comment">/* SCC register offsets */</span>
00102 <span class="preprocessor">#define M75_R00     0x00    </span><span class="comment">/* WR00 &amp; RR00 */</span>
00103 <span class="preprocessor">#define M75_R01     0x01    </span><span class="comment">/* WR01 &amp; RR01 */</span>
00104 <span class="preprocessor">#define M75_R02     0x02    </span><span class="comment">/* WR02 &amp; RR02 */</span>
00105 <span class="preprocessor">#define M75_R03     0x03    </span><span class="comment">/* WR03 &amp; RR03 */</span>
00106 <span class="preprocessor">#define M75_R04     0x04    </span><span class="comment">/* WR04 &amp; RR04 */</span>
00107 <span class="preprocessor">#define M75_R05     0x05    </span><span class="comment">/* WR05 &amp; RR05 */</span>
00108 <span class="preprocessor">#define M75_R06     0x06    </span><span class="comment">/* WR06 &amp; RR06 */</span>
00109 <span class="preprocessor">#define M75_R07     0x07    </span><span class="comment">/* WR07 &amp; WR07' &amp; RR07 */</span>
00110 <span class="preprocessor">#define M75_R08     0x08    </span><span class="comment">/* WR08 &amp; RR08 */</span>
00111 <span class="preprocessor">#define M75_R09     0x09    </span><span class="comment">/* WR09 &amp; RR09 */</span>
00112 <span class="preprocessor">#define M75_R10     0x0A    </span><span class="comment">/* WR10 &amp; RR10 */</span>
00113 <span class="preprocessor">#define M75_R11     0x0B    </span><span class="comment">/* WR11 &amp; RR11 */</span>
00114 <span class="preprocessor">#define M75_R12     0x0C    </span><span class="comment">/* WR12 &amp; RR12 */</span>
00115 <span class="preprocessor">#define M75_R13     0x0D    </span><span class="comment">/* WR13 &amp; RR13 */</span>
00116 <span class="preprocessor">#define M75_R14     0x0E    </span><span class="comment">/* WR14 &amp; RR14 */</span>
00117 <span class="preprocessor">#define M75_R15     0x0F    </span><span class="comment">/* WR15 &amp; RR15 */</span>
00118 
00119 <span class="comment">/* M75 register bit definitions */</span>
00120 <span class="comment">/* global regs */</span>
00121 <span class="preprocessor">#define M75_FIFO_STATREG_TXFIFO_EMPTY 0x10  </span><span class="comment">/* Tx FIFOs empty */</span>
00122 <span class="preprocessor">#define M75_FIFO_STATREG_TXEN         0x80  </span><span class="comment">/* enable Tx FIFOs */</span>
00123 
00124 <span class="comment">/* WR00 */</span>
00125 <span class="preprocessor">#define M75_SCC_WR00_POINT_HIGH     0x08    </span><span class="comment">/* Point High */</span>
00126 <span class="preprocessor">#define M75_SCC_WR00_RST_EXT_STAT   0x10    </span><span class="comment">/* Reset Ext/Status Interrupts */</span>
00127 <span class="preprocessor">#define M75_SCC_WR00_SEND_ABORT     0x18    </span><span class="comment">/* SDLC Send Abort */</span>
00128 <span class="preprocessor">#define M75_SCC_WR00_EN_INT_NXT_RX  0x20    </span><span class="comment">/* Enable Int on Next Rx Char */</span>
00129 <span class="preprocessor">#define M75_SCC_WR00_RST_TXINT      0x28    </span><span class="comment">/* Reset Tx Int Pending */</span>
00130 <span class="preprocessor">#define M75_SCC_WR00_RST_ERROR      0x30    </span><span class="comment">/* Reset Error */</span>
00131 <span class="preprocessor">#define M75_SCC_WR00_RST_HIGH_IUS   0x38    </span><span class="comment">/* Reset Highest IUS */</span>
00132 
00133 <span class="preprocessor">#define M75_SCC_WR00_RST_RX_CRC     0x40    </span><span class="comment">/* Reset Rx CRC Checker */</span>
00134 <span class="preprocessor">#define M75_SCC_WR00_RST_TX_CRC     0x80    </span><span class="comment">/* Reset Tx CRC Generator */</span>
00135 <span class="preprocessor">#define M75_SCC_WR00_RST_UNDERR_EOM 0xC0    </span><span class="comment">/* Reset Tx Underrun/EOM Latch */</span>
00136 
00137 <span class="comment">/* WR01 */</span>
00138 <span class="preprocessor">#define M75_SCC_WR01_EXT_IE         0x01    </span><span class="comment">/* Ext Int Enable */</span>
00139 <span class="preprocessor">#define M75_SCC_WR01_TX_IE          0x02    </span><span class="comment">/* Tx Int Enable */</span>
00140 <span class="preprocessor">#define M75_SCC_WR01_PAR_SPEC_COND  0x04    </span><span class="comment">/* Parity is Special Condition */</span>
00141 
00142 <span class="preprocessor">#define M75_SCC_WR01_RX_FIRST_SPEC_IE 0x08  </span><span class="comment">/* MASK: Rx Int On First Char or Special Condition */</span>
00143 <span class="preprocessor">#define M75_SCC_WR01_RX_ALL_SPEC_IE   0x10  </span><span class="comment">/* MASK: Rx Int On All Char or Special Condition */</span>
00144 <span class="preprocessor">#define M75_SCC_WR01_RX_SPEC_ONLY_IE  0x18  </span><span class="comment">/* MASK: Rx Int On Special Condition Only */</span>
00145 
00146 <span class="comment">/* WR03 */</span>
00147 <span class="preprocessor">#define M75_SCC_WR03_RX_EN          0x01    </span><span class="comment">/* Rx Enable */</span>
00148 
00149 <span class="comment">/* WR05 */</span>
00150 <span class="preprocessor">#define M75_SCC_WR05_TX_CRC_EN      0x01    </span><span class="comment">/* Tx CRC Enable */</span>
00151 <span class="preprocessor">#define M75_SCC_WR05_TX_EN          0x08    </span><span class="comment">/* Tx Enable */</span>
00152 <span class="preprocessor">#define M75_SCC_WR05_TX_BPC_MASK    0x60    </span><span class="comment">/* Tx Bits/Character Mask */</span>
00153 <span class="preprocessor">#define M75_SCC_WR05_TX_5BPC        0x00    </span><span class="comment">/* Tx 5 Bits(Or Less)/Char */</span>
00154 <span class="preprocessor">#define M75_SCC_WR05_TX_6BPC        0x20    </span><span class="comment">/* Tx 6 Bits/Char */</span>
00155 <span class="preprocessor">#define M75_SCC_WR05_TX_7BPC        0x40    </span><span class="comment">/* Tx 7 Bits/Char */</span>
00156 <span class="preprocessor">#define M75_SCC_WR05_TX_8BPC        0x60    </span><span class="comment">/* Tx 8 Bits/Char */</span>
00157 
00158 <span class="comment">/* WR07 */</span>
00159 <span class="preprocessor">#define M75_SCC_WR07P_TX_FIFO_EMPTY 0x20    </span><span class="comment">/* Tx FIFO Empty */</span>
00160 
00161 <span class="comment">/* WR09 */</span>
00162 <span class="preprocessor">#define M75_SCC_WR09_MIE            0x08    </span><span class="comment">/* Master Interrupt Enable */</span>
00163 <span class="preprocessor">#define M75_SCC_WR09_RST_CHB        0x40    </span><span class="comment">/* Channel Reset B */</span>
00164 <span class="preprocessor">#define M75_SCC_WR09_RST_CHA        0x80    </span><span class="comment">/* Channel Reset A */</span>
00165 <span class="preprocessor">#define M75_SCC_WR09_RST_HW         0xC0    </span><span class="comment">/* Force HW Reset */</span>
00166 
00167 <span class="comment">/* WR14 */</span>
00168 <span class="preprocessor">#define M75_SCC_WR14_BRG_EN         0x01        </span><span class="comment">/* BR Generator Enable */</span>
00169 
00170 <span class="comment">/* WR15 */</span>
00171 <span class="preprocessor">#define M75_SCC_WR15_WR7P_EN        0x01    </span><span class="comment">/* WR7' SDLC Feature Enable */</span>
00172 <span class="preprocessor">#define M75_SCC_WR15_SDLC_FIFO_EN   0x04    </span><span class="comment">/* SDLC Status FIFO Enable */</span>
00173 <span class="preprocessor">#define M75_SCC_WR15_DCD_IE         0x08    </span><span class="comment">/* DCD Interrupt enable */</span>
00174 <span class="preprocessor">#define M75_SCC_WR15_SYNC_HUNT_IE   0x10    </span><span class="comment">/* SYNC/HUNT Interrupt enable */</span>
00175 <span class="preprocessor">#define M75_SCC_WR15_CTS_IE         0x20    </span><span class="comment">/* CTS Interrupt enable */</span>
00176 <span class="preprocessor">#define M75_SCC_WR15_TX_UNDR_EOM_IE 0x40    </span><span class="comment">/* Tx Underrun/EOM Interrupt enable */</span>
00177 <span class="preprocessor">#define M75_SCC_WR15_BREAK_ABORT_IE 0x80    </span><span class="comment">/* Break/Abort Interrupt enable */</span>
00178 
00179 <span class="comment">/* RR00 */</span>
00180 <span class="preprocessor">#define M75_SCC_RR00_RX_CHAR_AVAIL  0x01    </span><span class="comment">/* Rx Character Available */</span>
00181 <span class="preprocessor">#define M75_SCC_RR00_ZERO_CNT       0x02    </span><span class="comment">/* Zero Count */</span>
00182 <span class="preprocessor">#define M75_SCC_RR00_TX_BUF_EMPTY   0x04    </span><span class="comment">/* Tx Buffer Empty */</span>
00183 <span class="preprocessor">#define M75_SCC_RR00_DCD            0x08    </span><span class="comment">/* DCD */</span>
00184 <span class="preprocessor">#define M75_SCC_RR00_SYNC_HUNT      0x10    </span><span class="comment">/* Sync/Hunt */</span>
00185 <span class="preprocessor">#define M75_SCC_RR00_CTS            0x20    </span><span class="comment">/* CTS */</span>
00186 <span class="preprocessor">#define M75_SCC_RR00_TX_UNDR_EOM    0x40    </span><span class="comment">/* Tx Underrun/EOM */</span>
00187 <span class="preprocessor">#define M75_SCC_RR00_BREAK_ABORT    0x80    </span><span class="comment">/* Break/Abort */</span>
00188 
00189 <span class="comment">/* RR01 */</span>
00190 <span class="preprocessor">#define M75_SCC_RR01_ALL_SENT       0x01    </span><span class="comment">/* All Sent */</span>
00191 <span class="preprocessor">#define M75_SCC_RR01_ERR_PAR        0x10    </span><span class="comment">/* Parity Error */</span>
00192 <span class="preprocessor">#define M75_SCC_RR01_ERR_RX_OVR     0x20    </span><span class="comment">/* Rx Overrun Error */</span>
00193 <span class="preprocessor">#define M75_SCC_RR01_ERR_CRC_FRM    0x40    </span><span class="comment">/* CRC/Framing Error */</span>
00194 <span class="preprocessor">#define M75_SCC_RR01_END_FRAME      0x80    </span><span class="comment">/* End Of Frame (SDLC) */</span>
00195 
00196 <span class="comment">/* RR03 */</span>
00197 <span class="preprocessor">#define M75_SCC_RR03_CHB_EXTSTAT_IP 0x01    </span><span class="comment">/* Channel B Ext/Status Interrupt pending */</span>
00198 <span class="preprocessor">#define M75_SCC_RR03_CHB_TX_IP      0x02    </span><span class="comment">/* Channel B Tx Interrupt pending */</span>
00199 <span class="preprocessor">#define M75_SCC_RR03_CHB_RX_IP      0x04    </span><span class="comment">/* Channel B Rx Interrupt pending */</span>
00200 <span class="preprocessor">#define M75_SCC_RR03_CHA_EXTSTAT_IP 0x08    </span><span class="comment">/* Channel A Ext/Status Interrupt pending */</span>
00201 <span class="preprocessor">#define M75_SCC_RR03_CHA_TX_IP      0x10    </span><span class="comment">/* Channel A Tx Interrupt pending */</span>
00202 <span class="preprocessor">#define M75_SCC_RR03_CHA_RX_IP      0x20    </span><span class="comment">/* Channel A Rx Interrupt pending */</span>
00203 
00204 <span class="comment">/* RR07 */</span>
00205 <span class="preprocessor">#define M75_SCC_RR07_BC_MASK        0x3F    </span><span class="comment">/* Byte Count Mask */</span>
00206 <span class="preprocessor">#define M75_SCC_RR07_FDA            0x40    </span><span class="comment">/* FIFO Data Available */</span>
00207 <span class="preprocessor">#define M75_SCC_RR07_FOS            0x80    </span><span class="comment">/* FIFO Overflow Status */</span>
00208 
00209 <span class="comment">/* other defines */</span>
00210 <span class="preprocessor">#define M75_DELAY           100     </span><span class="comment">/* Delay in msec */</span>
00211 <span class="preprocessor">#define M75_SYNC_MODE       1       </span><span class="comment">/* Default mode is SYNC */</span>
00212 <span class="preprocessor">#define FRAME_NUM_DEF       0x010   </span><span class="comment">/* Default maximum frame number */</span>
00213 <span class="preprocessor">#define FRAME_SIZE_DEF      0x800   </span><span class="comment">/* Default maximum frame size */</span>
00214 <span class="preprocessor">#define GETSETBLOCK_TOUT    0x000   </span><span class="comment">/* Default maximum frame size */</span>
00215 <span class="preprocessor">#define M75_WR01_MASK_INT   0x1F    </span><span class="comment">/* Mask IEs in WR01 */</span>
00216 <span class="preprocessor">#define M75_WR15_MASK_INT   0xFA    </span><span class="comment">/* Mask Ext/Status IEs in WR15 */</span>
00217 
00218 <span class="preprocessor">#ifdef M75_SUPPORT_BREAK_ABORT</span>
00219 <span class="preprocessor"></span><span class="preprocessor">    #define M75_WR15_EN_INT (M75_SCC_WR15_TX_UNDR_EOM_IE | M75_SCC_WR15_BREAK_ABORT_IE) </span><span class="comment">/* Interrupts to be enabled */</span>
00220                                     <span class="comment">/* Break/Abort, TxUnderr/EOM */</span>
00221 <span class="preprocessor">#else</span>
00222 <span class="preprocessor"></span><span class="preprocessor">    #define M75_WR15_EN_INT (M75_SCC_WR15_TX_UNDR_EOM_IE)   </span><span class="comment">/* Interrupts to be enabled */</span>
00223                                      <span class="comment">/* Tx Underrun/EOM */</span>
00224 <span class="preprocessor">#endif</span>
00225 <span class="preprocessor"></span>
00226 <span class="comment">/* Macros for accessing SCC registers */</span>
00227 <span class="preprocessor">#define WRITE_SCC_COMM( ma,ch,val )                     \</span>
00228 <span class="preprocessor">    do {                                                \</span>
00229 <span class="preprocessor">        if( ch == 0 ){  </span><span class="comment">/* write to channel A */</span>        \
00230             MWRITE_D8( ma, COMM_REG_A, val );           \
00231             IDBGWRT_6( (DBH, "Write COMM_REG_A %02X\n", val) ); \
00232         } else {        <span class="comment">/* write to channel B */</span>        \
00233             MWRITE_D8( ma, COMM_REG_B, val );           \
00234             IDBGWRT_6( (DBH, "Write COMM_REG_B %02X\n", val) ); \
00235         }                                               \
00236     } while( 0 )
00237 
00238 <span class="preprocessor">#define READ_SCC_COMM( ma,ch,val )                      \</span>
00239 <span class="preprocessor">    do {                                                \</span>
00240 <span class="preprocessor">        if( ch == 0 ){  </span><span class="comment">/* write to channel A */</span>        \
00241             val = MREAD_D8( ma, COMM_REG_A );   \
00242             IDBGWRT_6( (DBH, "Read  COMM_REG_A %02X\n", val) ); \
00243         } else {        <span class="comment">/* write to channel B */</span>        \
00244             val = MREAD_D8( ma, COMM_REG_B );   \
00245             IDBGWRT_6( (DBH, "Read  COMM_REG_B %02X\n", val) ); \
00246         }                                               \
00247     } while( 0 )
00248 
00249 <span class="preprocessor">#define WRITE_SCC_REG( ma,ch,reg,val )                              \</span>
00250 <span class="preprocessor">    do {                                                            \</span>
00251 <span class="preprocessor">        OSS_IRQ_STATE irqStateWAcc;                                 \</span>
00252 <span class="preprocessor">        irqStateWAcc = OSS_IrqMaskR(llHdl-&gt;osHdl, llHdl-&gt;irqHdl);   \</span>
00253 <span class="preprocessor">        WRITE_SCC_COMM( ma,ch,reg );                                \</span>
00254 <span class="preprocessor">        WRITE_SCC_COMM( ma,ch,val );                                \</span>
00255 <span class="preprocessor">        if( reg == M75_R08) {   </span><span class="comment">/* data register, do nothing more */</span>\
00256         } else if( reg != M75_R07 ) { <span class="comment">/* normal SCC register */</span>     \
00257             <span class="comment">/* mirror it */</span>                                         \
00258             *llHdl-&gt;chan[ch].sccRegs.wrp[reg] = val;                \
00259         } else if( (reg == M75_R07) &amp;&amp;                              \
00260                    (llHdl-&gt;chan[ch].sccRegs.wr15 &amp; M75_SCC_WR15_WR7P_EN) ) {<span class="comment">/* WR7P */</span>  \
00261             llHdl-&gt;chan[ch].sccRegs.wr7p = val;                     \
00262         } else if( reg == M75_R07 ){                     <span class="comment">/* WR07 */</span> \
00263             llHdl-&gt;chan[ch].sccRegs.wr07 = val;                     \
00264         }                                                           \
00265         OSS_IrqRestore( llHdl-&gt;osHdl, llHdl-&gt;irqHdl, irqStateWAcc ); \
00266         IDBGWRT_5( (DBH, "Write ch %d SCC Reg %02d: %02X\n", ch, reg, val) ); \
00267     } while( 0 )
00268 
00269 <span class="preprocessor">#define READ_SCC_REG( ma,ch,reg,val )                               \</span>
00270 <span class="preprocessor">    do {                                                            \</span>
00271 <span class="preprocessor">        OSS_IRQ_STATE irqStateRAcc;                                 \</span>
00272 <span class="preprocessor">        irqStateRAcc = OSS_IrqMaskR(llHdl-&gt;osHdl, llHdl-&gt;irqHdl);   \</span>
00273 <span class="preprocessor">        WRITE_SCC_COMM( ma,ch,reg );                                \</span>
00274 <span class="preprocessor">        READ_SCC_COMM( ma,ch,val );                                 \</span>
00275 <span class="preprocessor">        OSS_IrqRestore( llHdl-&gt;osHdl, llHdl-&gt;irqHdl, irqStateRAcc ); \</span>
00276 <span class="preprocessor">        IDBGWRT_5( (DBH, "Read  ch %d SCC Reg %02d: %02X\n", ch, reg, val) ); \</span>
00277 <span class="preprocessor">    } while( 0 )</span>
00278 <span class="preprocessor"></span>
<a name="l00280"></a><a class="code" href="m75__int_8h.html#a109">00280</a> <span class="preprocessor">#define DEVSEM_UNLOCK(llHdl) \</span>
00281 <span class="preprocessor"> if( llHdl-&gt;devSemHdl ) OSS_SemSignal( llHdl-&gt;osHdl, llHdl-&gt;devSemHdl );</span>
00282 <span class="preprocessor"></span>
00284 <span class="comment">/* ??? while( error == ERR_OSS_SIG_OCCURED ) might be a problem in Linux???*/</span>
<a name="l00285"></a><a class="code" href="m75__int_8h.html#a110">00285</a> <span class="preprocessor">#define DEVSEM_LOCK(llHdl) \</span>
00286 <span class="preprocessor"> if( llHdl-&gt;devSemHdl ){ \</span>
00287 <span class="preprocessor">     int32 error;\</span>
00288 <span class="preprocessor">     do {\</span>
00289 <span class="preprocessor">         error=OSS_SemWait( llHdl-&gt;osHdl, llHdl-&gt;devSemHdl, OSS_SEM_WAITFOREVER );\</span>
00290 <span class="preprocessor">     } while( error == ERR_OSS_SIG_OCCURED );\</span>
00291 <span class="preprocessor"> }</span>
00292 <span class="preprocessor"></span>
00293 <span class="comment">/*-----------------------------------------+</span>
00294 <span class="comment">|  TYPEDEFS                                |</span>
00295 <span class="comment">+-----------------------------------------*/</span>
00296 
<a name="l00298"></a><a class="code" href="structSCC__REG.html">00298</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00299"></a><a class="code" href="structSCC__REG.html#o0">00299</a>     u_int8          wr00;   
<a name="l00300"></a><a class="code" href="structSCC__REG.html#o1">00300</a>     u_int8          wr01;   
<a name="l00301"></a><a class="code" href="structSCC__REG.html#o2">00301</a>     u_int8          wr02;   
<a name="l00302"></a><a class="code" href="structSCC__REG.html#o3">00302</a>     u_int8          wr03;   
<a name="l00303"></a><a class="code" href="structSCC__REG.html#o4">00303</a>     u_int8          wr04;   
<a name="l00304"></a><a class="code" href="structSCC__REG.html#o5">00304</a>     u_int8          wr05;   
<a name="l00305"></a><a class="code" href="structSCC__REG.html#o6">00305</a>     u_int8          wr06;   
<a name="l00306"></a><a class="code" href="structSCC__REG.html#o7">00306</a>     u_int8          wr07;   
<a name="l00307"></a><a class="code" href="structSCC__REG.html#o8">00307</a>     u_int8          wr7p;   
<a name="l00308"></a><a class="code" href="structSCC__REG.html#o9">00308</a>     u_int8          wr09;   
<a name="l00309"></a><a class="code" href="structSCC__REG.html#o10">00309</a>     u_int8          wr10;   
<a name="l00310"></a><a class="code" href="structSCC__REG.html#o11">00310</a>     u_int8          wr11;   
<a name="l00311"></a><a class="code" href="structSCC__REG.html#o12">00311</a>     u_int8          wr12;   
<a name="l00312"></a><a class="code" href="structSCC__REG.html#o13">00312</a>     u_int8          wr13;   
<a name="l00313"></a><a class="code" href="structSCC__REG.html#o14">00313</a>     u_int8          wr14;   
<a name="l00314"></a><a class="code" href="structSCC__REG.html#o15">00314</a>     u_int8          wr15;   
00315     u_int8          *wrp[16]; <span class="comment">/* pointers to above registers */</span>
00316 } <a class="code" href="structSCC__REG.html">SCC_REG</a>;
00317 
00318 
<a name="l00320"></a><a class="code" href="structmqueue__ent.html">00320</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmqueue__ent.html">mqueue_ent</a> {
<a name="l00321"></a><a class="code" href="structmqueue__ent.html#o0">00321</a>     <span class="keyword">struct </span><a class="code" href="structmqueue__ent.html">mqueue_ent</a>   *next;      
<a name="l00322"></a><a class="code" href="structmqueue__ent.html#o1">00322</a>     u_int8              *<a class="code" href="structmqueue__ent.html#o1">frame</a>;     
<a name="l00323"></a><a class="code" href="structmqueue__ent.html#o2">00323</a>     u_int32             <a class="code" href="structmqueue__ent.html#o2">size</a>;       
<a name="l00324"></a><a class="code" href="structmqueue__ent.html#o3">00324</a>     u_int8              <a class="code" href="structmqueue__ent.html#o3">ready</a>;      
<a name="l00325"></a><a class="code" href="structmqueue__ent.html#o4">00325</a>     u_int8              <a class="code" href="structmqueue__ent.html#o4">xfering</a>;    
00326 } <a class="code" href="structmqueue__ent.html">MQUEUE_ENT</a>;
00327 
<a name="l00329"></a><a class="code" href="structMQUEUE__HEAD.html">00329</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00330"></a><a class="code" href="structMQUEUE__HEAD.html#o0">00330</a>     <a class="code" href="structmqueue__ent.html">MQUEUE_ENT</a>  *first;         
<a name="l00331"></a><a class="code" href="structMQUEUE__HEAD.html#o1">00331</a>     <a class="code" href="structmqueue__ent.html">MQUEUE_ENT</a>  *last;          
<a name="l00332"></a><a class="code" href="structMQUEUE__HEAD.html#o2">00332</a>     <span class="keywordtype">void</span>        *startAlloc;    
<a name="l00333"></a><a class="code" href="structMQUEUE__HEAD.html#o3">00333</a>     OSS_SEM_HANDLE *sem;        
<a name="l00334"></a><a class="code" href="structMQUEUE__HEAD.html#o4">00334</a>     u_int32     totEntries;     
<a name="l00335"></a><a class="code" href="structMQUEUE__HEAD.html#o5">00335</a>     u_int32     memAlloc;       
<a name="l00336"></a><a class="code" href="structMQUEUE__HEAD.html#o6">00336</a>     u_int32     maxFrameSize;   
<a name="l00337"></a><a class="code" href="structMQUEUE__HEAD.html#o7">00337</a>     u_int32     maxFrameNum;    
<a name="l00338"></a><a class="code" href="structMQUEUE__HEAD.html#o8">00338</a>     u_int8      errSent;        
<a name="l00339"></a><a class="code" href="structMQUEUE__HEAD.html#o9">00339</a>     u_int8      qinit;          
<a name="l00340"></a><a class="code" href="structMQUEUE__HEAD.html#o10">00340</a>     u_int8      waiting;        
00341 } <a class="code" href="structMQUEUE__HEAD.html">MQUEUE_HEAD</a>;
00342 
<a name="l00344"></a><a class="code" href="structCHN__OBJ.html">00344</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00345"></a><a class="code" href="structCHN__OBJ.html#o0">00345</a>     <a class="code" href="structMQUEUE__HEAD.html">MQUEUE_HEAD</a>     rxQ;            
<a name="l00346"></a><a class="code" href="structCHN__OBJ.html#o1">00346</a>     <a class="code" href="structMQUEUE__HEAD.html">MQUEUE_HEAD</a>     txQ;            
<a name="l00347"></a><a class="code" href="structCHN__OBJ.html#o2">00347</a>     OSS_SIG_HANDLE  *sig;           
<a name="l00348"></a><a class="code" href="structCHN__OBJ.html#o3">00348</a>     u_int32         asyRxSigWaterM; 
<a name="l00349"></a><a class="code" href="structCHN__OBJ.html#o4">00349</a>     int32       rxERR;          
<a name="l00350"></a><a class="code" href="structCHN__OBJ.html#o5">00350</a>     <a class="code" href="structSCC__REG.html">SCC_REG</a>     sccRegs;        
<a name="l00351"></a><a class="code" href="structCHN__OBJ.html#o6">00351</a>     u_int32     getBlockTout;   
<a name="l00352"></a><a class="code" href="structCHN__OBJ.html#o7">00352</a>     u_int32     setBlockTout;   
<a name="l00353"></a><a class="code" href="structCHN__OBJ.html#o8">00353</a>     u_int8      syncMode;       
<a name="l00354"></a><a class="code" href="structCHN__OBJ.html#o9">00354</a>     u_int8      irqEnabled;     
<a name="l00355"></a><a class="code" href="structCHN__OBJ.html#o10">00355</a>     u_int8      txUnderrEOMgot; 
<a name="l00356"></a><a class="code" href="structCHN__OBJ.html#o11">00356</a>     u_int8      txBufEmpty;     
<a name="l00357"></a><a class="code" href="structCHN__OBJ.html#o12">00357</a>     u_int8      rxStatCnt;      
00358 } <a class="code" href="structCHN__OBJ.html">CHN_OBJ</a>;
00359 
<a name="l00361"></a><a class="code" href="structLL__HANDLE.html">00361</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00362     <span class="comment">/* general */</span>
<a name="l00363"></a><a class="code" href="structLL__HANDLE.html#o0">00363</a>     int32           memAlloc;       
<a name="l00364"></a><a class="code" href="structLL__HANDLE.html#o1">00364</a>     OSS_HANDLE      *osHdl;         
<a name="l00365"></a><a class="code" href="structLL__HANDLE.html#o2">00365</a>     OSS_IRQ_HANDLE  *irqHdl;        
<a name="l00366"></a><a class="code" href="structLL__HANDLE.html#o3">00366</a>     DESC_HANDLE     *descHdl;       
<a name="l00367"></a><a class="code" href="structLL__HANDLE.html#o4">00367</a>     MACCESS         ma;             
<a name="l00368"></a><a class="code" href="structLL__HANDLE.html#o5">00368</a>     MDIS_IDENT_FUNCT_TBL idFuncTbl; 
<a name="l00369"></a><a class="code" href="structLL__HANDLE.html#o6">00369</a>     OSS_SEM_HANDLE  *devSemHdl;     
00370     <span class="comment">/* debug */</span>
<a name="l00371"></a><a class="code" href="structLL__HANDLE.html#o7">00371</a>     u_int32         dbgLevel;       
<a name="l00372"></a><a class="code" href="structLL__HANDLE.html#o8">00372</a>     DBG_HANDLE      *dbgHdl;        
<a name="l00374"></a><a class="code" href="structLL__HANDLE.html#o9">00374</a>     <a class="code" href="structCHN__OBJ.html">CHN_OBJ</a>         chan[2];        
<a name="l00376"></a><a class="code" href="structLL__HANDLE.html#o10">00376</a>     u_int8          irqEnabled;     
<a name="l00378"></a><a class="code" href="structLL__HANDLE.html#o11">00378</a>     u_int32         irqCount;       
<a name="l00380"></a><a class="code" href="structLL__HANDLE.html#o12">00380</a>     u_int32         idCheck;        
00381     u_int32         maxIrqTime;
00382 } <a class="code" href="structLL__HANDLE.html">LL_HANDLE</a>;
00383 
00384 <span class="comment">/* include files which need LL_HANDLE */</span>
00385 <span class="preprocessor">#include &lt;MEN/ll_entry.h&gt;</span>   <span class="comment">/* low-level driver jump table  */</span>
00386 <span class="preprocessor">#include &lt;<a class="code" href="m75__drv_8h.html">MEN/m75_drv.h</a>&gt;</span>   <span class="comment">/* M75 driver header file */</span>
00387 
00388 
00389 <span class="comment">/*--------------------------------------+</span>
00390 <span class="comment">|   STATICS                             |</span>
00391 <span class="comment">+--------------------------------------*/</span>
00392 
00393 <span class="comment">/*--------------------------------------+</span>
00394 <span class="comment">|   PROTOTYPES                          |</span>
00395 <span class="comment">+--------------------------------------*/</span>
00396 
00397 <span class="preprocessor">#ifdef __cplusplus</span>
00398 <span class="preprocessor"></span>    }
00399 <span class="preprocessor">#endif</span>
00400 <span class="preprocessor"></span>
00401 
00402 
00403 
00404 
00405 
</pre></div>
	</div>
</div>

<div class="footer">
<!-- Footer -->
	<p class="footer">
	Generated for M75 MDIS Driver using <a href="http://www.doxygen.org">doxygen</a>.<br>
	Copyright &copy; 2008 <a href="http://www.men.de">MEN Mikro Elektronik GmbH</a>. All Rights Reserved.
	</p>
</div>

</body>
</html>
